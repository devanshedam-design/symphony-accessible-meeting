<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Symphony - Accessible Video Conferencing</title>
  <link rel="stylesheet" href="./style.css">
  <!-- MediaPipe dependencies -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
</head>

<body>
  <!-- Setup / Auth Screen -->
  <div id="setupOverlay">
    <div class="setup-card">
      <h1>Symphony</h1>
      <p style="color: var(--text-dim);">Accessible HD Video Meetings</p>

      <div id="loginSection">
        <p id="userDisplayName" style="color: var(--text-dim); margin-bottom: 20px;"></p>
        <button id="loginBtn" class="primary-btn">Sign in with Google</button>
      </div>

      <div id="setupInitial" class="hidden">
        <button id="webcamButton" class="primary-btn" style="margin-top: 30px;">Enable Permissions</button>
      </div>

      <div id="setupActions" class="hidden">
        <div class="input-group">
          <label>Join a Session</label>
          <input type="text" id="callInput" placeholder="Meeting ID (from URL or host)">
          <button id="answerButton" class="primary-btn">Join Link</button>
        </div>
        <div style="margin: 20px 0; color: var(--text-dim); font-size: 12px;">OR</div>
        <button id="callButton" class="secondary-btn">Start New Meeting</button>
      </div>
    </div>
  </div>

  <!-- App Header -->
  <header>
    <div class="meeting-info">
      <span style="font-weight: bold; font-size: 18px; color: var(--primary);">Symphony</span>
      <div id="activeCallInfo" class="hidden">
        <div class="meeting-id-container">
          <span class="meeting-id" id="displayMeetId">ID: ---</span>
          <button class="copy-btn" id="copyBtn">Copy Link</button>
        </div>
      </div>
    </div>
    <div class="status-indicators">
      <span id="connectionStatus" style="font-size: 12px; color: var(--text-dim);">Connecting...</span>
      <span id="sttStatus" style="font-size: 12px; color: var(--accent); margin-left:15px;" class="hidden">â— Live
        Captions</span>
    </div>
  </header>

  <!-- Main Viewport -->
  <div id="mainWrapper">
    <main>
      <!-- Remote Participant Video -->
      <video id="remoteVideo" autoplay playsinline></video>

      <!-- Live Captions (Deaf Accessibility) -->
      <div id="captionOverlay" class="hidden">Waiting for speech...</div>

      <!-- Hand Gestures (Mute/Hearing Indicator) -->
      <div id="gestureToast">HELLO ğŸ‘‹</div>

      <!-- Signapse ASL Avatar viewport -->
      <div id="signapseContainer" class="hidden">
        <div class="avatar-label">ASL Avatar</div>
        <div id="signapseView">
          <div id="avatarPlaceholder" style="text-align: center; padding: 10px;">
            <div style="font-size: 40px; margin-top: 20px;">ğŸ‘¤</div>
            <p style="font-size: 11px; margin-top: 10px;">Signapse AI Ready</p>
          </div>
        </div>
      </div>

      <!-- Local Participant / PIP -->
      <div id="localVideoContainer">
        <video id="webcamVideo" autoplay playsinline muted></video>
        <canvas id="gestureCanvas"></canvas>
      </div>
    </main>

    <!-- Chat Sidebar -->
    <div id="sidePanel" class="hidden">
      <div class="panel-header">Session Chat</div>
      <div id="chatMessages">
        <!-- Messages go here -->
        <div class="chat-msg remote" style="font-size: 11px; font-style: italic;">Welcome to Symphony! Sharing your
          camera and audio enables accessible features.</div>
      </div>
      <div class="chat-input-area">
        <input type="text" id="chatInput" placeholder="Type a message...">
        <button id="sendChatBtn" style="background: none; border: none; font-size: 20px; cursor: pointer;">ğŸ“©</button>
      </div>
    </div>
  </div>

  <!-- Call Controls -->
  <div class="control-bar">
    <button class="control-btn" id="muteBtn" title="Mute Mic">
      <span class="icon">ğŸ¤</span>
      <span class="btn-label">Mute</span>
    </button>
    <button class="control-btn" id="videoBtn" title="Stop Video">
      <span class="icon">ğŸ“¹</span>
      <span class="btn-label">Stop Video</span>
    </button>
    <button class="control-btn" id="shareBtn" title="Share Screen">
      <span class="icon">ğŸ“º</span>
      <span class="btn-label">Share</span>
    </button>

    <div style="width: 30px; border-right: 1px solid #333; height: 30px;"></div>

    <button class="control-btn active" id="captionBtn" title="Accessible Captions">
      <span class="icon">CC</span>
      <span class="btn-label">Captions</span>
    </button>

    <button class="control-btn" id="aslBtn" title="ASL Interpreter">
      <span class="icon">ğŸ¤Ÿ</span>
      <span class="btn-label">ASL Avatar</span>
    </button>

    <button class="control-btn" id="chatBtn" title="Toggle Chat">
      <span class="icon">ğŸ’¬</span>
      <span class="btn-label">Chat</span>
    </button>

    <div style="width: 30px; border-right: 1px solid #333; height: 30px;"></div>

    <button class="control-btn danger" id="hangupButton" title="Leave">
      <span class="icon" style="font-size: 22px;">â˜</span>
      <span class="btn-label">End</span>
    </button>
  </div>

  <script type="module" src="/main.js"></script>
</body>

</html>